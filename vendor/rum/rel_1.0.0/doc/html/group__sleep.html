<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>RUM: Sleep functions</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Sleep functions</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
Function to support the sleeping of the node. 
<p>
Currently, this code only runs on the end nodes, as part of the sensor application. It can be called at any time to put the node to sleep, however.<p>
There is one paramater to note - the <a class="el" href="group__sleep.html#g14ae199e1518c5cdc08368fd78d6a437">WDOG_SLEEP</a> flag, which, when set, causes the sleep timing to be driven from the watchdog timer rather than the low-power AVR oscillator.<p>
If the low-power oscillator is used (WDOG_SLEEP = 0), then the oscillator must be driven from an on-board 32.768 KHz crystal. 
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sleep.html#g14ae199e1518c5cdc08368fd78d6a437">WDOG_SLEEP</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set this parameter to use the watchdog timer rather than the RTC oscillator for sleep timing.  <a href="#g14ae199e1518c5cdc08368fd78d6a437"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sleep.html#g93b5cdc0c2f6e617c9e63fac53cc8271">nodeSleep</a> (u16 tenthSeconds)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Put the node to sleep.  <a href="#g93b5cdc0c2f6e617c9e63fac53cc8271"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g5686c229bdef50123688ab6cb1404230"></a><!-- doxytag: member="sleep::ISR" ref="g5686c229bdef50123688ab6cb1404230" args="(TIMER2_COMPA_vect)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sleep.html#g5686c229bdef50123688ab6cb1404230">ISR</a> (TIMER2_COMPA_vect)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">TIMER2 Real Time Clock Sleep ISR function. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g43905d6fb5c4d433a49f527fa6ab811f"></a><!-- doxytag: member="sleep::ISR" ref="g43905d6fb5c4d433a49f527fa6ab811f" args="(WDT_vect)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sleep.html#g43905d6fb5c4d433a49f527fa6ab811f">ISR</a> (WDT_vect)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Watchdog timer vector handler. <br></td></tr>
</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="g14ae199e1518c5cdc08368fd78d6a437"></a><!-- doxytag: member="sleep.h::WDOG_SLEEP" ref="g14ae199e1518c5cdc08368fd78d6a437" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WDOG_SLEEP&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set this parameter to use the watchdog timer rather than the RTC oscillator for sleep timing. 
<p>
Setting WDOG_SLEEP to zero selects the RTC oscillator running at 32KHz. Setting WDOG_SLEEP to one selects the AVR's watchdog timer for timing sleep mode. 
<p>Definition at line <a class="el" href="sleep_8h-source.html#l00047">47</a> of file <a class="el" href="sleep_8h-source.html">sleep.h</a>.</p>

<p>Referenced by <a class="el" href="rum__application_8c-source.html#l00932">appTask()</a>, and <a class="el" href="sleep_8c-source.html#l00073">nodeSleep()</a>.</p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="g93b5cdc0c2f6e617c9e63fac53cc8271"></a><!-- doxytag: member="sleep.c::nodeSleep" ref="g93b5cdc0c2f6e617c9e63fac53cc8271" args="(u16 tenthSeconds)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nodeSleep           </td>
          <td>(</td>
          <td class="paramtype">u16&nbsp;</td>
          <td class="paramname"> <em>tenthSeconds</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Put the node to sleep. 
<p>
This function must put all the parts of the hardware to sleep, and wake them up.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tenthSeconds</em>&nbsp;</td><td>The time to sleep in tenths of a second. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="sleep_8c-source.html#l00073">73</a> of file <a class="el" href="sleep_8c-source.html">sleep.c</a>.</p>

<p>References <a class="el" href="mac_8h-source.html#l00695">macConfig_t::associated</a>, <a class="el" href="hal__avr_8h-source.html#l00723">AVR_ENTER_CRITICAL_REGION</a>, <a class="el" href="hal__avr_8h-source.html#l00727">AVR_LEAVE_CRITICAL_REGION</a>, <a class="el" href="at86rf23x__registermap_8h-source.html#l00074">BUSY_RX_AACK</a>, <a class="el" href="at86rf23x__registermap_8h-source.html#l00076">BUSY_TX_ARET</a>, <a class="el" href="hal__avr_8h-source.html#l00072">DSK001</a>, <a class="el" href="hal__avr_8h-source.html#l00135">HAL_INIT_ADC</a>, <a class="el" href="hal__avr_8h-source.html#l00137">HAL_STOP_ADC</a>, <a class="el" href="mac_8c-source.html#l00056">macConfig</a>, <a class="el" href="hal__avr_8h-source.html#l00096">PLATFORM</a>, <a class="el" href="at86rf23x__registermap_8h-source.html#l00070">PLL_ON</a>, <a class="el" href="radio_8c-source.html#l00842">radioEnterSleepMode()</a>, <a class="el" href="radio_8c-source.html#l00695">radioGetTrxState()</a>, <a class="el" href="radio_8c-source.html#l00871">radioLeaveSleepMode()</a>, <a class="el" href="radio_8c-source.html#l00740">radioSetTrxState()</a>, <a class="el" href="hal__avr_8h-source.html#l00067">RAVEN</a>, <a class="el" href="mac_8h-source.html#l00177">SERIAL</a>, <a class="el" href="serial_8c-source.html#l00207">serial_init()</a>, <a class="el" href="mac_8h-source.html#l00706">macConfig_t::sleeping</a>, <a class="el" href="hal__avr_8h-source.html#l00069">SPITFIRE</a>, and <a class="el" href="sleep_8h-source.html#l00047">WDOG_SLEEP</a>.</p>

<p>Referenced by <a class="el" href="rum__application_8c-source.html#l00555">appAssociateConfirm()</a>, <a class="el" href="rum__application_8c-source.html#l00632">appScanConfirm()</a>, <a class="el" href="rum__application_8c-source.html#l00932">appTask()</a>, <a class="el" href="mac__scan_8c-source.html#l00193">macScan()</a>, and <a class="el" href="sixlowpan__wake_8c-source.html#l00432">sixlowpanSleep_sleep()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="group__sleep_g93b5cdc0c2f6e617c9e63fac53cc8271_cgraph.png" border="0" usemap="#group__sleep_g93b5cdc0c2f6e617c9e63fac53cc8271_cgraph_map" alt=""></center>
<map name="group__sleep_g93b5cdc0c2f6e617c9e63fac53cc8271_cgraph_map">
<area shape="rect" href="group__radio.html#g324b48dc10d81456ce6ddd909f1d5e83" title="This function will put the radio transceiver to sleep." alt="" coords="139,183,283,210"><area shape="rect" href="group__radio.html#g80178b680aa26b7a8e1a1ce8a4a824b3" title="This function return the Radio Transceivers current state." alt="" coords="559,360,679,387"><area shape="rect" href="group__radio.html#g9b993ad338e639b917540d835079ce84" title="This function will take the radio transceiver from sleep mode and put it into the..." alt="" coords="137,82,284,108"><area shape="rect" href="group__radio.html#g9c32d026c082234626f5f900077221bc" title="This function will change the current state of the radio transceiver&#39;s internal..." alt="" coords="152,310,269,336"><area shape="rect" href="group__serial.html#g364b552759a6ed3c410d2ebb770975b7" title="USART initialization." alt="" coords="173,563,248,590"><area shape="rect" href="group__radio.html#g29bbaf755e336eeec99729db6be0226c" title="This function checks if the radio transceiver is sleeping." alt="" coords="376,107,456,134"><area shape="rect" href="group__radio.html#g847a215246618de0ba072d278f849da0" title="This function will reset the state machine (to TRX_OFF) from any of its states, except..." alt="" coords="335,208,497,235"><area shape="rect" href="group__arm.html#g4e55279d2a68db6e6127b853baee2127" title="This function writes a new value to one of the radio transceiver&#39;s subregisters..." alt="" coords="547,208,691,235"><area shape="rect" href="group__radio.html#g52391d34dfa78c4ad817e3f18b0de579" title="This function changes the prescaler on the CLKM pin." alt="" coords="347,6,485,32"><area shape="rect" href="group__mac__scan.html#g92f5262200ca45d25313feb542d9c30b" title="Reports whether the MAC is currently scanning." alt="" coords="361,462,471,488"><area shape="rect" href="group__radio.html#g2976f50bf538933d7eba0444494d6289" title="Returns the radio part number." alt="" coords="356,310,476,336"><area shape="rect" href="group__radio.html#gb18f99759fd3d798150020e91e7b46e9" title="Check whether the radio chip is busy." alt="" coords="372,360,460,387"></map>
</div>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Jun 8 18:39:12 2009 for RUM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
